{"name":"ruby-build Chef Cookbook","tagline":"Chef cookbook for ruby-build. Manages the ruby-build framework and its installed rubies. A LWRP is also defined.","body":"[![Build Status](https://secure.travis-ci.org/fnichol/chef-ruby_build.png?branch=master)](http://travis-ci.org/fnichol/chef-ruby_build)\r\n\r\n## <a name=\"description\"></a> Description\r\n\r\nManages the [ruby-build][rb_site] framework and its installed Rubies.\r\nA lightweight resources and providers ([LWRP][lwrp]) is also defined.\r\n\r\n## <a name=\"usage\"></a> Usage\r\n\r\nSimply include `recipe[ruby_build]` in your run\\_list to have ruby-build\r\ninstalled. You will also have access to the `ruby_build_ruby` resource. See\r\nthe [Resources and Providers](#lwrps) section for more details.\r\n\r\n## <a name=\"requirements\"></a> Requirements\r\n\r\n### <a name=\"requirements-chef\"></a> Chef\r\n\r\nTested on 0.10.8 but newer and older version should work just\r\nfine. File an [issue][issues] if this isn't the case.\r\n\r\n### <a name=\"requirements-platform\"></a> Platform\r\n\r\nThe following platforms have been tested with this cookbook, meaning that\r\nthe recipes and LWRPs run on these platforms without error:\r\n\r\n* ubuntu (10.04/10.10/11.04/11.10/12.04)\r\n* mac\\_os\\_x (10.7/10.8)\r\n* debian\r\n* freebsd\r\n* redhat\r\n* centos\r\n* fedora\r\n* amazon\r\n* scientific\r\n* suse\r\n\r\nPlease [report][issues] any additional platforms so they can be added.\r\n\r\n### <a name=\"requirements-cookbooks\"></a> Cookbooks\r\n\r\nThere are **no** external cookbook dependencies. However, if you are\r\ninstalling [JRuby][jruby] then a Java runtime will need to be installed.\r\nThe Opscode [java cookbook][java_cb] can be used on supported platforms.\r\n\r\n## <a name=\"installation\"></a> Installation\r\n\r\nDepending on the situation and use case there are several ways to install\r\nthis cookbook. All the methods listed below assume a tagged version release\r\nis the target, but omit the tags to get the head of development. A valid\r\nChef repository structure like the [Opscode repo][chef_repo] is also assumed.\r\n\r\n### <a name=\"installation-platform\"></a> From the Opscode Community Platform\r\n\r\nTo install this cookbook from the Opscode platform, use the *knife* command:\r\n\r\n    knife cookbook site install ruby_build\r\n\r\n### <a name=\"installation-berkshelf\"></a> Using Berkshelf\r\n\r\n[Berkshelf][berkshelf] is a cookbook dependency manager and development\r\nworkflow assistant. To install Berkshelf:\r\n\r\n    cd chef-repo\r\n    gem install berkshelf\r\n    berks init\r\n\r\nTo use the Community Site version:\r\n\r\n    echo \"cookbook 'ruby_build'\" >> Berksfile\r\n    berks install\r\n\r\nOr to reference the Git version:\r\n\r\n    repo=\"fnichol/chef-ruby_build\"\r\n    latest_release=$(curl -s https://api.github.com/repos/$repo/git/refs/tags \\\r\n    | ruby -rjson -e '\r\n      j = JSON.parse(STDIN.read);\r\n      puts j.map { |t| t[\"ref\"].split(\"/\").last }.sort.last\r\n    ')\r\n    cat >> Berksfile <<END_OF_BERKSFILE\r\n    cookbook 'ruby_build',\r\n      :git => 'git://github.com/$repo.git', :branch => '$latest_release'\r\n    END_OF_BERKSFILE\r\n\r\n### <a name=\"installation-librarian\"></a> Using Librarian-Chef\r\n\r\n[Librarian-Chef][librarian] is a bundler for your Chef cookbooks.\r\nTo install Librarian-Chef:\r\n\r\n    cd chef-repo\r\n    gem install librarian\r\n    librarian-chef init\r\n\r\nTo use the Opscode platform version:\r\n\r\n    echo \"cookbook 'ruby_build'\" >> Cheffile\r\n    librarian-chef install\r\n\r\nOr to reference the Git version:\r\n\r\n    repo=\"fnichol/chef-ruby_build\"\r\n    latest_release=$(curl -s https://api.github.com/repos/$repo/git/refs/tags \\\r\n    | ruby -rjson -e '\r\n      j = JSON.parse(STDIN.read);\r\n      puts j.map { |t| t[\"ref\"].split(\"/\").last }.sort.last\r\n    ')\r\n    cat >> Cheffile <<END_OF_CHEFFILE\r\n    cookbook 'ruby_build',\r\n      :git => 'git://github.com/$repo.git', :ref => '$latest_release'\r\n    END_OF_CHEFFILE\r\n    librarian-chef install\r\n\r\n## <a name=\"recipes\"></a> Recipes\r\n\r\n### <a name=\"recipes-default\"></a> default\r\n\r\nInstalls the ruby-build codebase and initializes Chef to use the Lightweight\r\nResources and Providers ([LWRPs][lwrp]).\r\n\r\n## <a name=\"attributes\"></a> Attributes\r\n\r\n### <a name=\"attributes-git-url\"></a> git_url\r\n\r\nThe Git URL which is used to install ruby-build.\r\n\r\nThe default is `\"git://github.com/sstephenson/ruby-build.git\"`.\r\n\r\n### <a name=\"attributes-git-ref\"></a> git_ref\r\n\r\nA specific Git branch/tag/reference to use when installing ruby-build. For\r\nexample, to pin ruby-build to a specific release:\r\n\r\n    node['ruby_build']['git_ref'] = \"v20111030\"\r\n\r\nThe default is `\"master\"`.\r\n\r\n### <a name=\"attributes-default-ruby-base-path\"></a> default_ruby_base_path\r\n\r\nThe default base path for a system-wide installed Ruby. For example, the\r\nfollowing resource:\r\n\r\n    ruby_build_ruby \"1.9.3-p0\"\r\n\r\nwill be installed into\r\n`\"#{node['ruby_build']['default_ruby_base_path']}/1.9.3-p0\"` unless a\r\n`prefix_path` attribute is explicitly set.\r\n\r\nThe default is `\"/usr/local/ruby\"`.\r\n\r\n### <a name=\"attributes-upgrade\"></a> upgrade\r\n\r\nDetermines how to handle installing updates to the ruby-build framework.\r\nThere are currently 2 valid values:\r\n\r\n* `\"none\"`, `false`, or `nil`: will not update ruby-build and leave it in its\r\n  current state.\r\n* `\"sync\"` or `true`: updates ruby-build to the version specified by the\r\n  `git_ref` attribute or the head of the master branch by default.\r\n\r\nThe default is `\"none\"`.\r\n\r\n## <a name=\"lwrps\"></a> Resources and Providers\r\n\r\n### <a name=\"lwrps-rbr\"></a> ruby_build_ruby\r\n\r\n#### <a name=\"lwrps-rbr-actions\"></a> Actions\r\n\r\n<table>\r\n  <thead>\r\n    <tr>\r\n      <th>Action</th>\r\n      <th>Description</th>\r\n      <th>Default</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td>install</td>\r\n      <td>\r\n        Build and install a Ruby from a definition file. See the ruby-build\r\n        readme<sup>(1)</sup> for more details.\r\n      </td>\r\n      <td>Yes</td>\r\n    </tr>\r\n    <tr>\r\n      <td>reinstall</td>\r\n      <td>\r\n        Force a recompiliation of the Ruby from source. The :install action\r\n        will skip a build if the target install directory already exists.\r\n      </td>\r\n      <td>&nbsp;</td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n1. [ruby-build readme][rb_readme]\r\n\r\n#### <a name=\"lwrps-rbr-attributes\"></a> Attributes\r\n\r\n<table>\r\n  <thead>\r\n    <tr>\r\n      <th>Attribute</th>\r\n      <th>Description</th>\r\n      <th>Default Value</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr>\r\n      <td>definition</td>\r\n      <td>\r\n        <b>Name attribute:</b> the name of a built-in definition<sup>(1)</sup>\r\n        or the path to a ruby-build definition file.\r\n      </td>\r\n      <td><code>nil</code></td>\r\n    </tr>\r\n    <tr>\r\n      <td>prefix_path</td>\r\n      <td>The path to which the Ruby will be installed.</td>\r\n      <td><code>nil</code></td>\r\n    </tr>\r\n    <tr>\r\n      <td>user</td>\r\n      <td>\r\n        A user which will own the installed Ruby. The default value of\r\n        <code>nil</code> denotes a system-wide Ruby (root-owned) is being\r\n        targeted. <b>Note:</b> if specified, the user must already exist.\r\n      </td>\r\n      <td><code>nil</code></td>\r\n    </tr>\r\n    <tr>\r\n      <td>group</td>\r\n      <td>\r\n        A group which will own the installed Ruby. The default value of\r\n        <code>nil</code> denotes a system-wide Ruby (root-owned) is being\r\n        targeted. <b>Note:</b> if specified, the group must already exist.\r\n      </td>\r\n      <td><code>nil</code></td>\r\n    </tr>\r\n    <tr>\r\n      <td>environment</td>\r\n      <td>\r\n        A Hash of additional environment variables<sup>(2)</sup>, such as\r\n        <code>CONFIGURE_OPTS</code> or <code>RUBY_BUILD_MIRROR_URL</code>.\r\n      </td>\r\n      <td><code>nil</code></td>\r\n    </tr>\r\n  </tbody>\r\n</table>\r\n\r\n1. [built-in definition][rb_definitions]\r\n2. [special environment variables][rb_environment]\r\n\r\n#### <a name=\"lwrps-rbr-examples\"></a> Examples\r\n\r\n##### Install Ruby\r\n\r\n    # See: https://github.com/sstephenson/ruby-build/issues/186\r\n    ruby_build_ruby \"ree-1.8.7-2012.02\" do\r\n      environment({ 'CONFIGURE_OPTS' => '--no-tcmalloc' })\r\n    end\r\n\r\n    ruby_build_ruby \"1.9.3-p0\" do\r\n      prefix_path \"/usr/local/ruby/ruby-1.9.3-p0\"\r\n      environment({\r\n        'RUBY_BUILD_MIRROR_URL' => 'http://local.example.com'\r\n      })\r\n\r\n      action      :install\r\n    end\r\n\r\n    ruby_build_ruby \"jruby-1.6.5\"\r\n\r\n**Note:** the install action is default, so the second example is more common.\r\n\r\n##### Install A Ruby For A User\r\n\r\n    ruby_build_ruby \"maglev-1.0.0\" do\r\n      prefix_path \"/home/deploy/.rubies/maglev-1.0.0\"\r\n      user        \"deploy\"\r\n      group       \"deploy\"\r\n    end\r\n\r\n##### Reinstall Ruby\r\n\r\n    ruby_build_ruby \"rbx-1.2.4\" do\r\n      prefix_path \"/opt/rbx-1.2.4\"\r\n\r\n      action      :reinstall\r\n    end\r\n\r\n**Note:** the Ruby will be built whether or not the Ruby exists in the\r\n`prefix_path` directory.\r\n\r\n## <a name=\"development\"></a> Development\r\n\r\n* Source hosted at [GitHub][repo]\r\n* Report issues/Questions/Feature requests on [GitHub Issues][issues]\r\n\r\nPull requests are very welcome! Make sure your patches are well tested.\r\nIdeally create a topic branch for every separate change you make.\r\n\r\n## <a name=\"license\"></a> License and Author\r\n\r\nAuthor:: [Fletcher Nichol][fnichol] (<fnichol@nichol.ca>) [![endorse](http://api.coderwall.com/fnichol/endorsecount.png)](http://coderwall.com/fnichol)\r\n\r\nCopyright 2011, Fletcher Nichol\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\r\n[berkshelf]:      http://berkshelf.com/\r\n[chef_repo]:      https://github.com/opscode/chef-repo\r\n[cheffile]:       https://github.com/applicationsonline/librarian/blob/master/lib/librarian/chef/templates/Cheffile\r\n[java_cb]:        http://community.opscode.com/cookbooks/java\r\n[jruby]:          http://jruby.org/\r\n[kgc]:            https://github.com/websterclay/knife-github-cookbooks#readme\r\n[librarian]:      https://github.com/applicationsonline/librarian#readme\r\n[lwrp]:           http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+%28LWRP%29\r\n[rb_readme]:      https://github.com/sstephenson/ruby-build#readme\r\n[rb_site]:        https://github.com/sstephenson/ruby-build\r\n[rb_environment]: https://github.com/sstephenson/ruby-build#special-environment-variables\r\n[rb_definitions]: https://github.com/sstephenson/ruby-build/tree/master/share/ruby-build\r\n\r\n[fnichol]:      https://github.com/fnichol\r\n[repo]:         https://github.com/fnichol/chef-ruby_build\r\n[issues]:       https://github.com/fnichol/chef-ruby_build/issues\r\n","google":"UA-29670723-1","note":"Don't delete this file! It's used internally to help with page regeneration."}